# Проектная работа "Веб-ларёк"
https://github.com/DashinNV/web-larek-frontend.git

Интернет-магазин с товарами для веб-разработчиков - Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

## Содержание

1. [Используемый стек технологий](#используемый-стек-технологий)
2. [Инструкция по установке и запуску](#инструкция-по-установке-и-запуску)
3. [Описание архитектуры проекта](#описание-архитектуры-проекта)
4. [Описание данных](#описание-данных)
5. [Модели данных](#модели-данных)
6. [Компоненты представления](#компоненты-представления)
7. [Описание событий](#описание-событий)


## Используемый стек технологий
HTML, SCSS, TS, Webpack
    

## Инструкция по установке и запуску
### Структура проекта
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

### Важные файлы
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

### Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
### Сборка

```
npm run build
```

или

```
yarn build
```
    
## Описание архитектуры проекта
В проекте реализован принцип MVP (Model-View-Presenter)- это архитектурный паттерн, который помогает организовать код и разделить ответственность между различными компонентами приложения. Он делит приложение на три основных компонента:

Model (Модель): Модель отвечает за управление данными приложения. Она взаимодействует с базой данных, API и выполняет бизнес-логику. Модель не знает ничего о пользовательском интерфейсе и не взаимодействует с ним напрямую.

View (Представление): Представление отвечает за отображение данных пользователю и взаимодействие с ним. Оно отображает интерфейс и получает ввод от пользователя (например, нажатия кнопок, ввод текста). View не содержит бизнес-логики и не управляет состоянием данных.

EventEmitter выступает в роли Presenter (Представитель): Представитель связывает Модель и Представление. Он получает события от View, обрабатывает их, взаимодействует с Model для получения или изменения данных, а затем обновляет View с использованием полученной информации. Presenter содержит всю бизнес-логику и отвечает за управление состоянием приложения.

### Базовый код
### Класс `Api` 
Обеспечивает базовые методы для взаимодействия с API

Методы:
- `handleResponse` - метод обрабатывает ответ от сервера.
- `get` -  метод используется для выполнения HTTP-запроса типа GET, чтобы получить данные с сервера.
- `post` - метод используется для выполнения HTTP-запроса типа POST (или других методов, таких как PUT и DELETE), чтобы отправить данные на сервер.

### Класс `EventEmitter`
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:

Методы:
 - `on` - подписка на событие;
 - `emit` - инициализация события;
 - `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.


## Описание данных

### Карточка товара
```typescript
interface IProductItem {
    id: string;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number | null;
  }
```

### Данные о заказе
```typescript
interface IOrder {
    payment: string;
    email: string;
    phone: string;
    address: string;
    total: number;
    items: string[];
}
```

### Данные для отображения карточек товара на главной странице
```typescript
type TProductItemsMainPage = Pick<IProductItem, 'category' | 'title' | 'image' | 'price'>
```

### Данные для отображения модального окна карточки товара
```typescript
type TProductItems = Pick<IProductItem, 'category' | 'title' | 'description' | 'image' | 'price'>
```

### Данные для отображения модального окна корзины
```typescript
type TBasket = Pick<IProductItem, 'id' | 'title' | 'price'>
```

### Данные для отображения модального окна способ оплаты и адрес доставки
```typescript
type TBillingInfo = Pick<IOrder, 'payment' | 'address'>
```
### Данные для отображения модального окна email и телефон
```typescript
type TCustometInfo = Pick<IOrder, 'email' | 'phone'>
```
## Модели данных

### _Класс `ProductsItemList`_ 
Управляет коллекцией товаров, позволяет добавлять новые элементы и получать текущий список товаров.

Методы:
- `addProductItem` - метод добавляет товар в коллекцию.

### _Класс `Order`_ 
Управляет данными заказа и выполняет проверку валидности ввода пользователя.
Поля класса:
- `address` - хранит адрес заказчика.
- `email` - хранит адрес электронной почты заказчика.
- `phone` - хранит номер телефона заказчика.

Методы:
- `validationAddress` - метод выполняет валидацию адреса. 
- `validationPyment` - метод выполняет валидацию методов платежа.
- `validationEmail` - метод проверяет валидацио адреса электронной почты.
- `validationPhone` - метод проверяет валидацию номера телефона.

### _Класс `Basket`_ 
Управляет данными корзины товаров и считает общую стоимость заказа. Он позволяет добавлять товары в корзину, удалять товары из корзины и очищать корзину.

Методы:
- `addProductItem` - метод добавляет товар в корзину.
- `deleteProductItem` - метод удаляет товар из корзины.
- `clearBasket` - метод очищает корзину.

## Компоненты представления
Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.

### _Класс `ProductCardView`_ 
Управляет отображением карточки товара на веб странице.
Поля класса:
- `template:` HTMLElement - корневой элемент карточки, клонированный из HTML-шаблона.
- `title:` HTMLElement - элемент для отображения названия товара.
- `price:` HTMLElement - элемент для отображения цены товара.
- `category:` HTMLElement - элемент для отображения категории товара.
- `image:` HTMLImageElement - элемент изображения товара.
- `product:` IProductItem - объект с данными товара.
- `events:` EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(prod: IProductItem, broker: EventEmitter)` - инициализирует экземпляр класса, клонирует шаблон карточки, находит необходимые элементы внутри шаблона, сохраняет данные товара и объект событий, вызывает обновление отображения и добавление обработчиков.
- `render()` - возвращает готовый элемент карточки для вставки в DOM.

### _Класс `DetailedProductCardView`_ 
Управляет отображением подробной карточки товара в модальном окне.
Поля класса:
- `template:` HTMLElement - корневой элемент карточки, клонированный из HTML-шаблона.
- `image:` HTMLImageElement - элемент для отображения изображения товара.
- `category:` HTMLElement - элемент для отображения категории товара.
- `title:` HTMLElement - элемент для отображения названия товара.
- `description:` HTMLElement - HTMLElement - элемент для отображения описания товара.
- `price:` HTMLElement -  - элемент для отображения цены товара.
- `submitButton:` HTMLButtonElement - элемент для отображения кнопки, которая используется для добавления товара в "Корзину". 
- `id:` string - уникальный идентификатор товара, используется для взаимодействия с "Корзиной" и другими компонентами.
- `events:` EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(prod: IProductItem, broker: EventEmitter)` - инициализирует экземпляр класса, клонирует шаблон карточки, находит необходимые элементы внутри шаблона, сохраняет данные товара и объект событий, вызывает обновление отображения и добавление обработчиков.
- `getButtonText()` - возвращает текст на кнопке.
- `setButtonText()` - устанавливает текст на кнопке.

### _Класс `Modal`_
Управляет отображением модального окна, обеспечивая инкапсуляцию логики, связанной с открытием, закрытием и изменением содержимого окна.
Поля класса:
- `modalContainer:` HTMLElement - хранит ссылку на контейнер модального окна.
- `modalContent:` HTMLElement - хранит ссылку на элемент, в который будет помещено содержимое модального окна.
- `content:` HTMLElement - элемент для отображения содержимого модального окна.
- `submitButton:` HTMLButtonElement - кнопка 
- `closeButton:` HTMLButtonElement - кнопка закрытия модального окна.

Методы:
- `constructor()` - инициализирует экземпляр класса.
- `setContent(content: HTMLElement)` - устанавливает содержимое модального окна.
- `open()` - открывает модальное окно и добавляет обработчик событий.
- `close()` - закрывает модальное окно, очищает его содержимое и удаляет обработчик событий.


### _Класс `BasketView`_
Управляет отображением данных модального окна корзины товаров.
Поля класса:
- `template:` HTMLElement -  инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.
- `ul:` HTMLElement - элемент списка для отображение товаров в корзине.
- `totalPrice:` HTMLElement - элемент для отображения общей стоимости товаров в корзине.
- `basketSubmitButton:` HTMLButtonElement - элемент для отображени кнопки отправки заказа.
- `events:` EventEmitter - EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(broker: EventEmitter)` - инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.
- `set list(content: BasketItem[])` - сеттер для обновления содержимого корзины.
- `set total()` - сеттер для обновления общей стоимости.
- `get total()` - геттер для получения общей стоимости.
- `setUl(elem: HTMLElement)`- метод для добавления элемента в список.
- `render()` - метод дл обновления шаблона корзины.

### _Класс `BasketItemView`_
Управляет отображением данных модального окна элемента корзины товаров.
Поля класса:
- `template:` HTMLElement -  инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.
- `index:` HTMLElement - элемент для отображения индекса товара в корзине.  
- `title:` HTMLElement - элемент для отображения названия товара в корзине.
- `price:` number - содержит цену товара в корзине.
- `priceElement:` HTMLElement - элемент для отображения цены товара вкорзине.
- `buttonDelete:` HTMLButtonElement - элемент для отображени кнопки удаления товара из корзины.
- `id:` streeng -  содержит уникальный идентификатор товара.
- `events:` EventEmitter - EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(broker: EventEmitter)` - инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.

### _Класс `BillingView`_ 
Управляет отображением содержимого модального окна и позволяет принять от пользователя метод оплаты и адрес.
Поля класса:
- `template:` HTMLElement - корневой элемент модального окна, клонированный из HTML-шаблона.
- `nextButton:` HTMLButtonElement - элемент для отображени кнопки далее.
- `buttonPayment:` HTMLButtonElement - элемент для отображения кнопок видов оплатыю.
- `inputAddress:` HTMLElement - элемент отображения поля ввода адреса доставки.
- `errorContainer` - элемент для отображения сообщения об ошибке.
- `selectedPaymentMethod:` string - содержит выбранный метод оплаты.
- `events:` EventEmitter - объект для управления пользовательскими событиями.


Методы:
- `constructor(broker: EventEmitter)` -  инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.
- `validation()` - отправляет данные на проверку.
- `setSubmitButtonState(isEnable: boolean)` - управляет внешним видом кнопок выбора методов оплаты.
- `showError(message: string)` - отображает сообщение об ошибке.
- `clearError()` - удаляет отображение сообщения об ошибке.
- `clear()` - очищает форму.

### _Класс `CustomerView`_ 
Управляет отображением содержимого модального окна и позволяет принять от пользователя номер телефона и Email.
Поля класса:
- `template:` HTMLElement - корневой элемент модального окна, клонированный из HTML-шаблона.
- `submitButton:` HTMLButtonElement - элемент дл отображения кнопки, которая используется для сохранения данных.
- `emailInput:` HTMLInputElement - элемент для отображения поля адреса электронной почты.
- `phoneInput:` HTMLInputElement - элемент для отображения поля номера телефона.
- `errorContainer` - элемент для отображения сообщения об ошибке.
- `email:` string - содержит адрес электронной почты. 
- `phone:` string - содержит номер телефона.
- `events:` EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(brokоer: EventEmitter)` - инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.
- `validation()` - отправляет данные на проверку.
- `setButtonText(text: string)`- отображает текст на кнопке.
- `setSubmitButtonState(isEnabled: boolean)`- отображает состояние кнопки.
- `showError(message: string)` - отображает сообщение об ошибке.
- `clearError()` - удаляет отображение сообщения об ошибке.
- `clear()` - очищает форму.

### _Класс `OrderIsPlacedView`_ 
Управляет отображением удачного заказа в модальном окне.
Поля класса:
- `template:` HTMLElement - корневой элемент модального окна, клонированный из HTML-шаблона.
- `submitButton:` HTMLButtonElement - элемент для отображения кнопки, которая используется для зарытия модального окна. 
- `total:` HTMLElement - элемент для отображения общей суммы заказа.
- `events:` EventEmitter - объект для управления пользовательскими событиями.

Методы:
- `constructor(broker: EventEmitter)` - 
инициализирует экземпляр класса, клонирует шаблон модального окна, находит необходимые элементы внутри шаблона и добавляет обработчик.

## Описание событий
Презентор в проекте реализован в коде основого файла index.js

### Обработчик события открытие модального окна карточки товара product:open
### Обработчик события добавление карточки товара в "Корзину" product:addBasket
### Обработчик события открытия модального окна "Корзины" basket:open
### Обработчик события добавление товара в "Корзину" basket:add
### Обработчик события удаления товара из "Корзины" basket:delete
### Обработчик события обновления "Корзины" basket:update
### Обработчик события оформление покупки товара basket:invoice
### Обработчик события валидация данных заказчика validation:customerView
### Обработчик события сохранения данных заказа customerView:success
### Обработчик события валидация данных биллинга validation:billingView
### Обработчик события сохранения данных заказа billingView:success
### Обработчик события сохранения данных заказа на сервере order:success
### Обработчик события успешной покупки success:close
